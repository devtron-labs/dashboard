import { useLocation, useNavigate } from 'react-router-dom'

import {
    ComponentSizeType,
    getSelectPickerOptionByValue,
    Icon,
    ROUTER_URLS,
    SelectPicker,
    SelectPickerOptionType,
} from '@devtron-labs/devtron-fe-common-lib'

import { VULNERABILITY_VIEW_TYPE_SELECT_OPTIONS } from './constants'
import { VulnerabilityViewTypes } from './types'

const VulnerabilityViewTypeSelect = () => {
    const navigate = useNavigate()
    const { pathname } = useLocation()

    const viewType =
        pathname === ROUTER_URLS.SECURITY_CENTER_VULNERABILITY_CVES
            ? VulnerabilityViewTypes.VULNERABILITIES
            : VulnerabilityViewTypes.DEPLOYMENTS

    const onChange = (selectedOption: SelectPickerOptionType<VulnerabilityViewTypes>) => {
        navigate(
            selectedOption.value === VulnerabilityViewTypes.VULNERABILITIES
                ? ROUTER_URLS.SECURITY_CENTER_VULNERABILITY_CVES
                : ROUTER_URLS.SECURITY_CENTER_VULNERABILITY_DEPLOYMENTS,
        )
    }

    return (
        <div className="w-150">
            <SelectPicker
                value={getSelectPickerOptionByValue(VULNERABILITY_VIEW_TYPE_SELECT_OPTIONS, viewType)}
                options={VULNERABILITY_VIEW_TYPE_SELECT_OPTIONS}
                inputId="search-type__select-picker"
                name="search-type__select-picker"
                size={ComponentSizeType.large}
                onChange={onChange}
                icon={<Icon name="ic-visibility-on" color={null} />}
            />
        </div>
    )
}

export default VulnerabilityViewTypeSelect
